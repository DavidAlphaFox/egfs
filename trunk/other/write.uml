Client->Metadata Server: create (FileName)
activate Metadata Server
Metadata Server->Client: {ok,FileID} / {error,Reason}
deactivate Metadata Server

Client->Metadata Server: open (FileName,Mode{r/w/a})
activate Metadata Server
Metadata Server->Client: {ok,FileID} / {error,Reason}
deactivate Metadata Server

Client->Metadata Server: getLocation (FileID)
activate Metadata Server
Metadata Server->Client: {ok,ChunkID[],ChunkLocation[]} / {error,Reason}
deactivate Metadata Server

loop write_chunks
Client->Data Server: write (ChunkID)
activate Data Server
Data Server->Client: {ok,connected} / {error,Reason}
Client->Data Server: DATA
Data Server->Client: ACK
Client->Data Server: DATA
Data Server->Client: ACK
Client->Data Server: DATA
Data Server->Client: ACK
Client->Data Server: DATA,CHUNKE_FIN
Data Server->Metadata Server: flush()
Data Server->Client: ACK,CHUNKE_FINISHED
deactivate Data Server
end

Client->Metadata Server: FILE_CLOSE
Metadata Server->Client: ok

